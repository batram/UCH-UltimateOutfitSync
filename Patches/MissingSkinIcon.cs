using System;
using System.IO;
using UnityEngine;
using UnityEngine.UI;

namespace UltimateOutfitSync
{
    class MissingSkinIcon : MonoBehaviour
    {
        public static string ObjectName = "SkinMissing";
        public int[] hash;
        public NameTag nameTag;

        public static MissingSkinIcon createMissingSkinIcon(NameTag nt, int[] hash)
        {
            var go = GameObject.Instantiate(nt.UCHNetIcon.gameObject, nt.UCHNetIcon.transform.parent);

            go.name = ObjectName;
            MissingSkinIcon missingSkin = go.AddComponent<MissingSkinIcon>();
            missingSkin.hash = hash;
            missingSkin.nameTag = nt;

            Image img = go.GetComponent<Image>();
            byte[] fileData = Convert.FromBase64String("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");
            (img.mainTexture as Texture2D).LoadImage(fileData);

            return missingSkin;
        }

        public void setIcon(bool show)
        {
            GameObject go = this.gameObject;
            go.SetActive(show);

            Image img = go.GetComponent<Image>();

            img.enabled = show;
        }

        public void showWarnMessage(string localizedName)
        {
            string message = "missing " + localizedName + " skin for [ " + nameTag.Currentname + " ]: " + UltimateOutfitMod.IntsToStringHash(hash);
            Debug.Log("SetOutfitsFromArray overwrite: " + message);

            GameState.ChatSystem.DisplayNewMessage(new ChatMessageDetails(Character.Animals.NONE, null, Color.white, message, EmoteMeanings.CHAT_Text, 0));
        }
    }
}